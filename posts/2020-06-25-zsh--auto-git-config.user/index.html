<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ZSH: auto git config.user | My Digital Chronicle</title>
<meta name="keywords" content="zsh, git">
<meta name="description" content="On my laptop and desktop I usually have many git repositories. Some of them are personal and some of them are from my main job. In companies it&rsquo;s common practice to have corporate email that used in repository configuration.
git config user.name &#34;Mr Anderson&#34; git config user.email &#34;anderson@corp.in&#34; In personal repository you may use some cool nickname and personal email.
git config user.name &#34;Neo&#34; git config user.email &#34;0xff@matr.ix&#34; But there is an headache to not forget configure every repository to be corporate or personal after cloning.">
<meta name="author" content="">
<link rel="canonical" href="http://undying.github.io/posts/2020-06-25-zsh--auto-git-config.user/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://undying.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://undying.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://undying.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://undying.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="http://undying.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5GK4JRS');</script>

<meta property="og:title" content="ZSH: auto git config.user" />
<meta property="og:description" content="On my laptop and desktop I usually have many git repositories. Some of them are personal and some of them are from my main job. In companies it&rsquo;s common practice to have corporate email that used in repository configuration.
git config user.name &#34;Mr Anderson&#34; git config user.email &#34;anderson@corp.in&#34; In personal repository you may use some cool nickname and personal email.
git config user.name &#34;Neo&#34; git config user.email &#34;0xff@matr.ix&#34; But there is an headache to not forget configure every repository to be corporate or personal after cloning." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://undying.github.io/posts/2020-06-25-zsh--auto-git-config.user/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-25T22:36:59+03:00" />
<meta property="article:modified_time" content="2020-06-25T22:36:59+03:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ZSH: auto git config.user"/>
<meta name="twitter:description" content="On my laptop and desktop I usually have many git repositories. Some of them are personal and some of them are from my main job. In companies it&rsquo;s common practice to have corporate email that used in repository configuration.
git config user.name &#34;Mr Anderson&#34; git config user.email &#34;anderson@corp.in&#34; In personal repository you may use some cool nickname and personal email.
git config user.name &#34;Neo&#34; git config user.email &#34;0xff@matr.ix&#34; But there is an headache to not forget configure every repository to be corporate or personal after cloning."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://undying.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ZSH: auto git config.user",
      "item": "http://undying.github.io/posts/2020-06-25-zsh--auto-git-config.user/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ZSH: auto git config.user",
  "name": "ZSH: auto git config.user",
  "description": "On my laptop and desktop I usually have many git repositories. Some of them are personal and some of them are from my main job. In companies it\u0026rsquo;s common practice to have corporate email that used in repository configuration.\ngit config user.name \u0026#34;Mr Anderson\u0026#34; git config user.email \u0026#34;anderson@corp.in\u0026#34; In personal repository you may use some cool nickname and personal email.\ngit config user.name \u0026#34;Neo\u0026#34; git config user.email \u0026#34;0xff@matr.ix\u0026#34; But there is an headache to not forget configure every repository to be corporate or personal after cloning.",
  "keywords": [
    "zsh", "git"
  ],
  "articleBody": "On my laptop and desktop I usually have many git repositories. Some of them are personal and some of them are from my main job. In companies it’s common practice to have corporate email that used in repository configuration.\ngit config user.name \"Mr Anderson\" git config user.email \"anderson@corp.in\" In personal repository you may use some cool nickname and personal email.\ngit config user.name \"Neo\" git config user.email \"0xff@matr.ix\" But there is an headache to not forget configure every repository to be corporate or personal after cloning. I’m using zsh and I have found easy solution for this.\nOn file system I keep corporate repositories in special folder like /repos. So I decided to make my default configuration to be personal, and change it in corporate repositories on demand.\nZsh have a hook system. You can create a function and specify in which hook you want to call it. There is a hook named chdir, it’s called when you changing your directory.\nThe algorithm is simple:\ncheck that current directory is a git repository if so, check in which directory it’s based if it’s corporate directory - set corporate email and name Here is a functions added to .zsrc:\n_git_config_user(){ case ${PWD} in *\"mycompany/repos\"*) git config user.email \"denis@mycompany.com\" git config user.name \"Denis Bozhok\" ;; *) return 0 esac } __git_cd_functions_set(){ [[ -d .git ]] || return 0 _git_config_user } chpwd_functions+=( __git_cd_functions_set ) Last string appends function __git_cd_functions_set to chpwd hooks chain:\nchpwd_functions+=( __git_cd_functions_set ) Now any repository placed in directory which path contains mycompany/repos will be configured to have corporate name and email.\n",
  "wordCount" : "262",
  "inLanguage": "en",
  "datePublished": "2020-06-25T22:36:59+03:00",
  "dateModified": "2020-06-25T22:36:59+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://undying.github.io/posts/2020-06-25-zsh--auto-git-config.user/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "My Digital Chronicle",
    "logo": {
      "@type": "ImageObject",
      "url": "http://undying.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://undying.github.io" accesskey="h" title="My Digital Chronicle (Alt + H)">My Digital Chronicle</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://undying.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      ZSH: auto git config.user
    </h1>
    <div class="post-meta"><span title='2020-06-25 22:36:59 +0300 MSK'>June 25, 2020</span>

</div>
  </header> 
  <div class="post-content"><p>On my laptop and desktop I usually have many git repositories. Some of them are personal and some of them are from my main job. In companies it&rsquo;s common practice to have corporate email that used in repository configuration.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git config user.name <span style="color:#e6db74">&#34;Mr Anderson&#34;</span>
</span></span><span style="display:flex;"><span>git config user.email <span style="color:#e6db74">&#34;anderson@corp.in&#34;</span>
</span></span></code></pre></div><p>In personal repository you may use some cool nickname and personal email.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git config user.name <span style="color:#e6db74">&#34;Neo&#34;</span>
</span></span><span style="display:flex;"><span>git config user.email <span style="color:#e6db74">&#34;0xff@matr.ix&#34;</span>
</span></span></code></pre></div><p>But there is an headache to not forget configure every repository to be corporate or personal after cloning.
I&rsquo;m using zsh and I have found easy solution for this.</p>
<p>On file system I keep corporate repositories in special folder like <code>&lt;company&gt;/repos</code>.
So I decided to make my default configuration to be personal, and change it in corporate repositories on demand.</p>
<p>Zsh have a <a href="http://zsh.sourceforge.net/Doc/Release/Functions.html">hook system</a>. You can create a function and specify in which hook you want to call it. There is a hook named chdir, it&rsquo;s called when you changing your directory.</p>
<p>The algorithm is simple:</p>
<ul>
<li>check that current directory is a git repository</li>
<li>if so, check in which directory it&rsquo;s based</li>
<li>if it&rsquo;s corporate directory - set corporate email and name</li>
</ul>
<p>Here is a functions added to .zsrc:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>_git_config_user<span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">case</span> <span style="color:#e6db74">${</span>PWD<span style="color:#e6db74">}</span> in
</span></span><span style="display:flex;"><span>    *<span style="color:#e6db74">&#34;mycompany/repos&#34;</span>*<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      git config user.email <span style="color:#e6db74">&#34;denis@mycompany.com&#34;</span>
</span></span><span style="display:flex;"><span>      git config user.name <span style="color:#e6db74">&#34;Denis Bozhok&#34;</span>
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>    *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>__git_cd_functions_set<span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[[</span> -d .git <span style="color:#f92672">]]</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  _git_config_user
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>chpwd_functions<span style="color:#f92672">+=(</span> __git_cd_functions_set <span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Last string appends function <code>__git_cd_functions_set</code> to chpwd hooks chain:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>chpwd_functions<span style="color:#f92672">+=(</span> __git_cd_functions_set <span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Now any repository placed in directory which path contains <code>mycompany/repos</code> will be configured to have corporate name and email.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://undying.github.io/tags/zsh/">zsh</a></li>
      <li><a href="http://undying.github.io/tags/git/">git</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="http://undying.github.io">My Digital Chronicle</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
